<fnx-app>
  <template [ngIf]="appContext.logged">
    <div class="layout--header">
      <header>
        <nav class="navbar">
          <h1>Complete Doddle
            <span *ngIf="isTesting()">!!! TESTING !!!</span>
          </h1>
          <span class="spacer"></span>
          <ul class="menu--horizontal">
            <li><span *ngIf="appContext.logged">{{ appContext.loggedUser['name'] }}</span>
              <ul class="menu--vertical">
                <li><a (click)="logout()">logout</a></li>
              </ul>
            </li>
          </ul>
        </nav>
      </header>
      <main>
        <div class="layout--sidebar">
          <aside style="width: 15em" class="flex--column">
            <ul class="menu--vertical flex--grow">
              <li><a href="#" routerLink="['Dashboard']">Dashboard</a></li>
              <li class="separator"><a href="#" routerLink="['Users']">Users</a></li>
            </ul>
            <p class="text--center bg--fnx no-margin padding">
              <a href="https://fnx.io/">fnx.io</a>
            </p>
          </aside>
          <main class="border--left">
            <router-outlet></router-outlet>
          </main>
        </div>
      </main>
    </div>
</template>

<template [ngIf]="!appContext.logged">
  <login-box (token)="authTokenChanged($event)" (user)="loggedUserChanged($event)"></login-box>
</template>

</fnx-app>
<fnx-modal (close)="closeError()" [hidden]="errorHeadline == null && errorMessage == null">
  <h3 header>{{errorHeadline}}</h3>
  <p main>{{errorMessage}}</p>
  <ul main *ngIf="errorList.isNotEmpty">
    <li *ngFor="let e of errorList">{{e["path"]}} {{e["message"]}}</li>
  </ul>
  <p footer class="buttonbar">
    <button class="btn" attr.href="mailto:support@fnx.io?subject=Complete Doddle {{errorHeadline}}">support</button>
    <span class="spacer"></span>
    <button class="btn bg--important" (click)="closeError()">ok</button>
  </p>
</fnx-modal>
